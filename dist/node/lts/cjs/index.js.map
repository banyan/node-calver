{"version":3,"file":"index.js","sources":["../../../../src/DateVersion.js","../../../../src/SemanticVersion.js","../../../../src/ModifierVersion.js","../../../../src/Version.js","../../../../src/index.js"],"sourcesContent":["export default class DateVersion {\n  static tags = ['YYYY', 'YY', '0Y', 'MM', '0M', 'WW', '0W', 'DD', '0D']\n\n  constructor(obj, parentSeperator) {\n    this['YYYY'] = null\n    this['YY'] = null\n    this['0Y'] = null\n    this['MM'] = null\n    this['0M'] = null\n    this['WW'] = null\n    this['0W'] = null\n    this['DD'] = null\n    this['0D'] = null\n\n    this.parentSeperator = parentSeperator\n    this.props = []\n    this.date = new Date(Date.now())\n\n    this.parse(obj)\n  }\n\n  parse(obj) {\n    for (const prop in obj) {\n      this[prop] = obj[prop]\n      this.props.push(prop)\n    }\n  }\n\n  inc(level) {\n    const yearstr = this.date.getUTCFullYear().toString()\n    this['YYYY'] = yearstr\n    this['YY'] = parseInt(yearstr.slice(2)).toString()\n    this['0Y'] = this['YY'].padStart(2, '0')\n\n    const monthstr = (this.date.getUTCMonth() + 1).toString()\n    this['MM'] = monthstr\n    this['0M'] = this['MM'].padStart(2, '0')\n\n    const weekstr = this.getUTCWeek(this.date).toString()\n    this['WW'] = weekstr\n    this['0W'] = this['WW'].padStart(2, '0')\n\n    const daystr = this.date.getUTCDate().toString()\n    this['DD'] = daystr\n    this['0D'] = this['DD'].padStart(2, '0')\n\n    return this\n  }\n\n  asObject() {\n    return this.props.reduce((memo, prop) => {\n      memo[prop] = this[prop]\n      return memo\n    }, {})\n  }\n\n  asString() {\n    const result = []\n    for (const tag of this.constructor.tags) {\n      if (this.props.indexOf(tag) !== -1) result.push(this[tag])\n    }\n    return result.join(this.parentSeperator)\n  }\n\n  getUTCWeek(date) {\n    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()))\n    const daynum = d.getUTCDay() || 7\n\n    d.setUTCDate(d.getUTCDate() + 4 - daynum)\n\n    const yearstart = new Date( Date.UTC(d.getUTCFullYear(), 0, 1) )\n\n    return Math.ceil((((d - yearstart) / 86400000) + 1)/7)\n  }\n}\n","export default class SemanticVersion {\n  static tags = ['MAJOR', 'MINOR', 'PATCH']\n\n  constructor(obj, parentSeperator) {\n    this.MAJOR = null\n    this.MINOR = null\n    this.PATCH = null\n\n    this.parentSeperator = parentSeperator\n    this.props = []\n\n    this.parse(obj)\n  }\n\n  parse(obj) {\n    for (const prop in obj) {\n      this[prop] = obj[prop]\n      this.props.push(prop)\n    }\n  }\n\n  inc(level) {\n    if (this.props.indexOf(level) === -1) {\n      throw new Error(`[CALVER]: You have requested to increment \"${level}\" but your format doesn't have it.`)\n    }\n\n    if (level == 'MAJOR') {\n      this.MAJOR = (parseInt(this.MAJOR) + 1).toString()\n      if (this.props.indexOf('MINOR') !== -1) this.MINOR = '0'\n      if (this.props.indexOf('PATCH') !== -1) this.PATCH = '0'\n    }\n    \n    if (level == 'MINOR') {\n      this.MINOR = (parseInt(this.MINOR) + 1).toString()\n      if (this.props.indexOf('PATCH') !== -1) this.PATCH = '0'\n    }\n\n    if (level == 'PATCH') {\n      this.PATCH = (parseInt(this.PATCH) + 1).toString()\n    }\n\n    return this\n  }\n\n  asObject() {\n    return this.props.reduce((memo, prop) => {\n      memo[prop] = this[prop]\n      return memo\n    }, {})\n  }\n\n  asString() {\n    const result = []\n    for (const tag of this.constructor.tags) {\n      if (this.props.indexOf(tag) !== -1) result.push(this[tag])\n    }\n    return result.join(this.parentSeperator)\n  }\n}\n","export default class ModifierVersion {\n  static seperator = '-'\n  static tags = ['DEV', 'ALPHA', 'BETA', 'RC']\n\n  constructor(obj, parentSeperator) {\n    this.DEV = null\n    this.ALPHA = null\n    this.BETA = null\n    this.RC = null\n\n    this.parentSeperator = parentSeperator\n    this.prop = null\n\n    this.parse(obj)\n  }\n\n  parse(obj) {\n    for (const prop in obj) {\n      this.prop = prop\n      this[prop] = obj[prop]\n    }\n  }\n\n  inc(level) {\n    if (level != this.prop) {\n      throw new Error(`[CALVER]: You have requested to increment \"${level}\" but your format doesn't have it.`)\n    }\n\n    this[this.prop] = (parseInt(this[this.prop]) + 1).toString()\n\n    return this\n  }\n\n  asObject() {\n    const result = {}\n    result[this.prop] = this[this.prop]\n    return result\n  }\n\n  asString() {\n    return `${this.constructor.seperator}${this.prop}${this.parentSeperator}${this[this.prop]}`\n  }\n}\n","import DateVersion from './DateVersion.js'\nimport SemanticVersion from './SemanticVersion.js'\nimport ModifierVersion from './ModifierVersion.js'\n\nexport default class Version {\n  constructor(version, seperator) {\n    this.seperator = seperator\n    this.versionStringHasModifier = version.versionStringHasModifier\n    this.datever = null\n    this.semanticver = null\n    this.modifierver = null\n\n    this.parse(version)\n  }\n\n  parse(version) {\n    if (Object.keys(version.calendar).length > 0) {\n      this.datever = new DateVersion(version.calendar, this.seperator)\n    }\n\n    if (Object.keys(version.semantic).length > 0) {\n      this.semanticver = new SemanticVersion(version.semantic, this.seperator)\n    }\n\n    if (Object.keys(version.modifier).length > 0) {\n      this.modifierver = new ModifierVersion(version.modifier, this.seperator)\n    }\n  }\n\n  inc(levels) {\n    const l = levels[0]\n\n    const removeModifier = levels.length === 1 \n      && ['MAJOR', 'MINOR', 'PATCH', 'CALENDAR'].indexOf(l) !== -1 \n      && this.versionStringHasModifier ? true : false\n    if (removeModifier) {\n      this.modifierver = null\n\n      return this\n    }\n\n    if (l == 'CALENDAR') this.datever.inc(l)\n    if (SemanticVersion.tags.indexOf(l) !== -1) this.semanticver.inc(l)\n    if (ModifierVersion.tags.indexOf(l) !== -1) this.modifierver.inc(l)\n\n    if (levels.length > 1) {\n      const l2 = levels[1]\n\n      if (ModifierVersion.tags.indexOf(l2) !== -1 && \n          ModifierVersion.tags.indexOf(l) === -1) this.modifierver.inc(l2)\n      else {\n        throw new Error(`The second tag of the level should be a modifier tag. You specified \"${l2}\" as the second tag and \"${l}\" as the first tag.`)\n      }\n    }\n\n    return this\n  }\n\n  asObject() {\n    const result = {\n      calendar: {},\n      semantic: {},\n      modifier: {}\n    }\n\n    if (this.datever) result.calendar = this.datever.asObject()\n    if (this.semanticver) result.semantic = this.semanticver.asObject()\n    if (this.modifierver) result.modifier = this.modifierver.asObject()\n\n    return result\n  }\n}\n","import DateVersion from './DateVersion.js'\nimport SemanticVersion from './SemanticVersion.js'\nimport ModifierVersion from './ModifierVersion.js'\nimport Version from './Version.js'\n\nclass Calver {\n  constructor() {\n    this.seperator = '.'\n    this.levels = ['CALENDAR', 'MAJOR', 'MINOR', 'PATCH', ...ModifierVersion.tags]\n  }\n\n  inc(format, version, levels) {\n    levels = this.validateLevels(levels)\n    format = this.validateFormat(format, levels)\n    version = this.parseVersion(version, format, levels)\n\n    const obj = (new Version(version, this.seperator)).inc(levels).asObject()\n\n    return this.asString(format, obj)\n  }\n\n  getTagType(tag) {\n    tag = tag.toUpperCase()\n\n    if (DateVersion.tags.indexOf(tag) !== -1) return 'calendar'\n    if (SemanticVersion.tags.indexOf(tag) !== -1) return 'semantic'\n    if (ModifierVersion.tags.indexOf(tag) !== -1) return 'modifier'\n    \n    return undefined;\n  }\n\n  asString(format, obj) {\n    const result = []\n\n    for (const tag of format.sorted) {\n      if (DateVersion.tags.indexOf(tag) !== -1) {\n        result.push(obj.calendar[tag])\n      }\n      if (SemanticVersion.tags.indexOf(tag) !== -1) {\n        result.push(obj.semantic[tag])\n      }\n      if (ModifierVersion.tags.indexOf(tag) !== -1 && obj.modifier) {\n        result.push(ModifierVersion.seperator + tag.toLowerCase() + this.seperator + obj.modifier[tag])\n      }\n    }\n\n    return result\n      .join(this.seperator)\n      .replace(this.seperator + ModifierVersion.seperator, ModifierVersion.seperator)\n  }\n\n  parseVersion(version, format, levels) {\n    const map = {\n      versionStringHasModifier: /(dev|DEV|alpha|ALPHA|beta|BETA|rc|RC)/.test(version),\n      sorted: {},\n      calendar: {},\n      semantic: {},\n      modifier: {}\n    }\n\n    let startIndex=0, endIndex=0\n    for (const tag of format.sorted) {\n      endIndex = version.indexOf(this.seperator, startIndex+1)\n      if (endIndex === -1) endIndex = undefined\n\n      let value = version.slice(startIndex, endIndex)\n\n      if (value.indexOf(ModifierVersion.seperator) !== -1) {\n        endIndex = version.indexOf(ModifierVersion.seperator, startIndex+1)\n        value = version.slice(startIndex, endIndex)\n      }\n\n      if (ModifierVersion.tags.indexOf(value.toUpperCase()) !== -1) {\n        if (value.toUpperCase() != tag) value = '-1'\n        else value = version.slice(startIndex + value.length + 1)\n      }\n\n      if (isNaN(startIndex)) {\n        value = ModifierVersion.tags.indexOf(tag) !== -1 ? '-1' : '0'\n      }\n\n      if (value == '') {\n        value = '0'\n      }\n\n      map.sorted[tag] = value\n      if (format.calendar.indexOf(tag) !== -1) map.calendar[tag] = value\n      if (format.semantic.indexOf(tag) !== -1) map.semantic[tag] = value\n      if (format.modifier.indexOf(tag) !== -1) map.modifier[tag] = value\n\n      startIndex = endIndex + 1\n    }\n\n    return map\n  }\n\n  validateFormat(format, levels) {\n    const result = {\n      sorted: [],\n      calendar: [],\n      semantic: [],\n      modifier: []\n    }\n\n    const tags = format.toUpperCase().split(this.seperator)\n\n    for (const tag of tags) {\n      if (DateVersion.tags.indexOf(tag) !== -1) result.calendar.push(tag)\n      else if (SemanticVersion.tags.indexOf(tag) !== -1) result.semantic.push(tag)\n      else throw new Error(`[CALVER]: Invalid format tag \"${tag}\".`)\n\n      result.sorted.push(tag)\n    }\n\n    for (const level of levels) {\n      if (ModifierVersion.tags.indexOf(level) !== -1) {\n        result.modifier.push(level)\n        result.sorted.push(level)\n      }\n    }\n\n    return result\n  }\n\n  validateLevels(levels) {\n    const result = []\n    const arr = levels.split('.')\n\n    for (const level of arr) {\n      const formatted = level.toUpperCase()\n      if (this.levels.indexOf(formatted) !== -1) {\n        result.push(formatted)\n      }\n      else {\n        throw new Error(`[CALVER]: Invalid level \"${level}\".`)\n      }\n    }\n\n    return result\n  }\n}\n\nexport default new Calver()\n"],"names":["DateVersion","constructor","obj","parentSeperator","props","date","Date","now","parse","prop","push","inc","level","yearstr","getUTCFullYear","toString","parseInt","slice","padStart","monthstr","getUTCMonth","weekstr","getUTCWeek","daystr","getUTCDate","asObject","reduce","memo","asString","result","tag","tags","indexOf","join","d","UTC","getFullYear","getMonth","getDate","daynum","getUTCDay","setUTCDate","yearstart","Math","ceil","SemanticVersion","MAJOR","MINOR","PATCH","Error","ModifierVersion","DEV","ALPHA","BETA","RC","seperator","Version","version","versionStringHasModifier","datever","semanticver","modifierver","Object","keys","calendar","length","semantic","modifier","levels","l","removeModifier","l2","Calver","format","validateLevels","validateFormat","parseVersion","getTagType","toUpperCase","undefined","sorted","toLowerCase","replace","map","test","startIndex","endIndex","value","isNaN","split","arr","formatted"],"mappings":"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"}